<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="mamba">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="mamba">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="mamba">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>mamba</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">mamba</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/ about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/ categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-schedule">
          <a href="/schedule/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br />
            
            日程表
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/24/Vue中的v-if和v-show的使用场景/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="张哲">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mamba">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/24/Vue中的v-if和v-show的使用场景/" itemprop="url">Vue中的v-if和v-show的使用场景</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-24T13:34:56+08:00">
                2019-06-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-官方文档"><a href="#1-官方文档" class="headerlink" title="1. 官方文档"></a>1. <a href="https://cn.vuejs.org/v2/guide/conditional.html#v-if-vs-v-show" target="_blank" rel="noopener">官方文档</a></h3><h3 id="2-v-if-和-v-show-的区别"><a href="#2-v-if-和-v-show-的区别" class="headerlink" title="2. v-if 和 v-show 的区别"></a>2. v-if 和 v-show 的区别</h3><h4 id="官方解释"><a href="#官方解释" class="headerlink" title="官方解释"></a>官方解释</h4><p>v-if 是“真正”的条件渲染，因为它会确保在切换过程中条件块内的事件监听器和子组件适当地被销毁和重建。</p>
<p>v-if 也是惰性的：如果在初始渲染时条件为假，则什么也不做——直到条件第一次变为真时，才会开始渲染条件块。</p>
<p> 相比之下，v-show 就简单得多——不管初始条件是什么，元素总是会被渲染，并且只是简单地基于 CSS 进行切换。</p>
<h4 id="汇总别人的"><a href="#汇总别人的" class="headerlink" title="汇总别人的"></a>汇总别人的</h4><p>（1）手段：v-if是动态的向DOM树内添加或者删除DOM元素；v-show是通过设置DOM元素的display样式属性控制显隐；</p>
<p>（2）编译过程：v-if切换有一个局部编译/卸载的过程，切换过程中合适地销毁和重建内部的事件监听和子组件；v-show只是简单的基于css切换；</p>
<p>（3）编译条件：v-if是惰性的，如果初始条件为假，则什么也不做；只有在条件第一次变为真时才开始局部编译（编译被缓存？编译被缓存后，然后再切换的时候进行局部卸载); v-show是在任何条件下（首次条件是否为真）都被编译，然后被缓存，而且DOM元素保留；</p>
<p>（4）性能消耗：v-if有更高的切换消耗；v-show有更高的初始渲染消耗；</p>
<h3 id="3-v-if-和-v-show-的使用场景"><a href="#3-v-if-和-v-show-的使用场景" class="headerlink" title="3. v-if 和 v-show 的使用场景"></a>3. v-if 和 v-show 的使用场景</h3><h4 id="官方解释-1"><a href="#官方解释-1" class="headerlink" title="官方解释"></a>官方解释</h4><p>一般来说，v-if 有更高的切换开销，而 v-show 有更高的初始渲染开销。</p>
<p>因此，如果需要非常频繁地切换，则使用v-show 较好；如果在运行时条件很少改变，则使用 v-if 较好。</p>
<h4 id="汇总别人的-1"><a href="#汇总别人的-1" class="headerlink" title="汇总别人的"></a>汇总别人的</h4><p>v-if适合运营条件不大可能改变；v-show适合频繁切换。</p>
<p>（1）对于管理系统的权限列表的展示，这里可以使用v-if来渲染，如果使用到v-show，对于用户没有的权限，在网页的源码中，仍然能够显示出该权限，如果用v-if，网页的源码中就不会显示出该权限。（在前后台分离情况下，后台不负责渲染页面的场景。）</p>
<p>（2）对于前台页面的数据展示，这里推荐使用v-show，这样可以减少开发中不必要的麻烦。</p>
<h3 id="4-总结"><a href="#4-总结" class="headerlink" title="4. 总结"></a>4. 总结</h3><p>v-if和v-show都是用来控制元素的渲染。v-if判断是否加载，可以减轻服务器的压力，在需要时加载,但有更高的切换开销;v-show调整DOM元素的CSS的dispaly属性，可以使客户端操作更加流畅，但有更高的初始渲染开销。如果需要非常频繁地切换，则使用 v-show 较好；如果在运行时条件很少改变，则使用 v-if 较好。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/13/web性能优化简单总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="张哲">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mamba">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/13/web性能优化简单总结/" itemprop="url">web性能优化简单总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-13T13:45:14+08:00">
                2019-06-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <pre><code>（1） 减少http请求次数：CSS Sprites, JS、CSS源码压缩、图片大小控制合适；网页Gzip，CDN托管，data缓存 ，图片服务器。

（2） 前端模板 JS+数据，减少由于HTML标签导致的带宽浪费，前端用变量保存AJAX请求结果，每次操作本地变量，不用请求，减少请求次数

（3） 用innerHTML代替DOM操作，减少DOM操作次数，优化javascript性能。

（4） 当需要设置的样式很多时设置className而不是直接操作style。

（5） 少用全局变量、缓存DOM节点查找的结果。减少IO读取操作。

（6） 避免使用CSS Expression（css表达式)又称Dynamic properties(动态属性)。

（7） 图片预加载，将样式表放在顶部，将脚本放在底部  加上时间戳。

（8） 避免在页面的主体布局中使用table，table要等其中的内容完全下载之后才会显示出来，显示比div+css布局慢。
对普通的网站有一个统一的思路，就是尽量向前端优化、减少数据库操作、减少磁盘IO。向前端优化指的是，在不影响功能和体验的情况下，能在浏览器执行的不要在服务端执行，能在缓存服务器上直接返回的不要到应用服务器，程序能直接取得的结果不要到外部取得，本机内能取得的数据不要到远程取，内存能取到的不要到磁盘取，缓存中有的不要去数据库查询。减少数据库操作指减少更新次数、缓存结果减少查询次数、将数据库执行的操作尽可能的让你的程序完成（例如join查询），减少磁盘IO指尽量不使用文件系统作为缓存、减少读写文件次数等。程序优化永远要优化慢的部分，换语言是无法“优化”的
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/02/Ajax和JSONP-二/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="张哲">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mamba">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/06/02/Ajax和JSONP-二/" itemprop="url">Ajax和JSONP(二)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-06-02T16:06:50+08:00">
                2019-06-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Ajax"><a href="#Ajax" class="headerlink" title="Ajax"></a>Ajax</h2><p>Ajax（asynchronous JavaScript and XML）是使用客户端上的许多 Web 技术，创建异步 Web 应用的一种 Web 开发技术。借助 Ajax，Web 应用可以异步（在后台）向服务器发送数据和从服务器检索数据，而不会干扰现有页面的显示和行为。通过将数据交换层与表示层分离，Ajax 允许网页和扩展 Web 应用程序动态更改内容，而无需重新加载整个页面。实际上，现在通常将 XML 替换为 JSON，因为 JavaScript 对 JSON 有原生支持优势。</p>
<p>XMLHttpRequest API 经常用于异步通信。此外还有最近流行的fetch API。</p>
<h2 id="使用-Ajax-的优缺点分别是什么？"><a href="#使用-Ajax-的优缺点分别是什么？" class="headerlink" title="使用 Ajax 的优缺点分别是什么？"></a>使用 Ajax 的优缺点分别是什么？</h2><h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><ul>
<li>交互性更好。来自服务器的新内容可以动态更改，无需重新加载整个页面。</li>
<li>减少与服务器的连接，因为脚本和样式只需要被请求一次。</li>
<li>状态可以维护在一个页面上。JavaScript 变量和 DOM 状态将得到保持，因为主容器页面未被重新加载。</li>
<li>基本上包括大部分 SPA 的优点。</li>
</ul>
<h3 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h3><ul>
<li>动态网页很难收藏。</li>
<li>如果 JavaScript 已在浏览器中被禁用，则不起作用。</li>
<li>有些网络爬虫不执行 JavaScript，也不会看到 JavaScript 加载的内容。</li>
<li>基本上包括大部分 SPA 的缺点。</li>
</ul>
<h2 id="请说明-JSONP-的工作原理，它为什么不是真正的-Ajax？"><a href="#请说明-JSONP-的工作原理，它为什么不是真正的-Ajax？" class="headerlink" title="请说明 JSONP 的工作原理，它为什么不是真正的 Ajax？"></a>请说明 JSONP 的工作原理，它为什么不是真正的 Ajax？</h2><p>JSONP（带填充的 JSON）是一种通常用于绕过 Web 浏览器中的跨域限制的方法，因为 Ajax 不允许跨域请求。</p>
<p>JSONP 通过<code>script</code>标签发送跨域请求，通常使用callback查询参数，例如：<code>https://example.com callback=printData。</code>然后服务器将数据包装在一个名为printData的函数中并将其返回给客户端。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- https://mydomain.com --&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">function printData(data) &#123;</span><br><span class="line">  console.log(`My name is $&#123;data.name&#125;!`);</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;script src=&quot;https://example.com?callback=printData&quot;&gt;&lt;/script&gt;</span><br><span class="line">// 文件加载自 https://example.com?callback=printData</span><br><span class="line">printData(&#123; name: &apos;Yang Shun&apos; &#125;);</span><br></pre></td></tr></table></figure>
<p>客户端必须在其全局范围内具有<code>printData</code>函数，并且在收到来自跨域的响应时，该函数将由客户端执行。</p>
<p>JSONP 可能具有一些安全隐患。由于 JSONP 是纯 JavaScript 实现，它可以完成 JavaScript 所能做的一切，因此需要信任 JSONP 数据的提供者。</p>
<p>现如今，<code>跨来源资源共享（CORS）</code> 是推荐的主流方式，JSONP 已被视为一种比较 hack 的方式</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/14/web性能优化/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="张哲">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mamba">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/14/web性能优化/" itemprop="url">web性能优化</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-14T11:39:52+08:00">
                2019-05-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://link.juejin.im/?target=https%3A%2F%2Fdeveloper.yahoo.com%2Fperformance%2Frules.html%3Fguccounter%3D1" target="_blank" rel="noopener">内容框架来自YAHOO</a></p>
<img src="/2019/05/14/web性能优化/性能优化.png" title="This is an 性能优化 image">
<h4 id="1-Content"><a href="#1-Content" class="headerlink" title="1. Content"></a>1. Content</h4><h5 id="1-1-Make-Fewer-HTTP-Requests"><a href="#1-1-Make-Fewer-HTTP-Requests" class="headerlink" title="1.1 Make Fewer HTTP Requests"></a>1.1 Make Fewer HTTP Requests</h5><p>Minimize HTTP Requests减少/最小化 http 请求数。</p>
<p>到终端用户的响应时间80%花在前端：大部分用于下载组件（js/css/image/flash等等）。减少组件数就是减少渲染页面所需的http请求数。这是更快页面的关键。</p>
<p>减少组件数的一个方法就是简化页面设计。保持富内容的页面且能减少http请求，有以下几个技术：</p>
<ul>
<li>Combined files。合并文件，如合并js，合并css都能减少请求数。如果页面间脚本和样式差异很大，合并会更具挑战性。</li>
<li>CSS Sprites。雪碧图可以合并多个背景图片，通过background-image 和 background-position 来显示不同部分。</li>
<li>Image maps。合并多个图片到一个图片，一般用于如导航条。由于定义坐标的枯燥和易错，一般<em>不推荐</em>。</li>
<li>Inline images。使用data:url scheme来內连图片。<br>减少请求数是为第一次访问页面的用户提高性能的最重要的指导。</li>
</ul>
<h5 id="1-2-Reduce-DNS-Lookups"><a href="#1-2-Reduce-DNS-Lookups" class="headerlink" title="1.2 Reduce DNS Lookups"></a>1.2 Reduce DNS Lookups</h5><p>减少DNS查询。</p>
<p>就像电话簿，你在浏览器地址栏输入网址，通过DNS查询得到网站真实IP。</p>
<p>DNS查询被缓存来提高性能。这种缓存可能发生在特定的缓存服务器（ISP/local area network维护），或者用户的计算机。DNS信息留存在操作系统DNS缓存中（在windows中就是 DNS Client Serve ）。大多浏览器有自己的缓存，独立于操作系统缓存。只要浏览器在自己的缓存里有某条DNS记录，它就不会向操作系统发DNS解析请求。</p>
<p>IE默认缓存DNS记录30分钟，FireFox默认缓存1分钟。</p>
<p>当客户端的DNS缓存是空的，DNS查找次数等于页面中的唯一域名数。</p>
<p>减少DNS请求数可能会减少并行下载数。避免DNS查找减少响应时间，但减少并行下载数可能会增加响应时间。指导原则是组件可以分散在至少2个但不多于4个的不同域名。这是两者的妥协。</p>
<h5 id="1-3-Avoid-Redirects"><a href="#1-3-Avoid-Redirects" class="headerlink" title="1.3 Avoid Redirects"></a>1.3 Avoid Redirects</h5><p>避免跳转。</p>
<p>跳转用301或302状态码来达成。一个301响应http头的例子：</p>
<p>HTTP/1.1 301 Moved Permanently<br>Location: <a href="http://example.com/newuri" target="_blank" rel="noopener">http://example.com/newuri</a><br>Content-Type: text/html<br>浏览器自动跳转到Location指定的路径。跳转所需的所有信息都在http头，所以http主体一般是空的。301 302响应一般不会被缓存，除非有额外的头部信息，比如Expires或Cache-Control指定要缓存。meta刷新标签或 JavaScript 也可以跳转，但如果真要跳转，3xx跳转更好，主要是保证返回键可用。</p>
<p>跳转显然拖慢响应速度。在跳转的页面被获取前浏览器没什么能渲染，没什么组件能下载。</p>
<p>最浪费的跳转之一发生在url尾部slash（/）缺失。比如<a href="http://astrology.yahoo.com/astrology会301跳转到http://astrology.yahoo.com/astrology/。这可以被Apache等服务器修复，用Alias，mod_rewrite等等。" target="_blank" rel="noopener">http://astrology.yahoo.com/astrology会301跳转到http://astrology.yahoo.com/astrology/。这可以被Apache等服务器修复，用Alias，mod_rewrite等等。</a></p>
<h5 id="1-4-Make-Ajax-Cacheable"><a href="#1-4-Make-Ajax-Cacheable" class="headerlink" title="1.4 Make Ajax Cacheable"></a>1.4 Make Ajax Cacheable</h5><p>让Ajax可缓存。</p>
<p>使用ajax的好处是可以向用户提供很快的反馈，因为它是向后台异步请求数据。但是，这些异步请求不保证用户等待的时间——异步不意味着瞬时。</p>
<p>提高ajax性能的最重要的方法是让响应被缓存，即在Add an Expires or a Cache-Control Header中讨论的 Expires 。其它方法是：</p>
<ul>
<li>gzip组件</li>
<li>减少DNS查找</li>
<li>压缩JS</li>
<li>避免跳转</li>
<li>设置ETags<h5 id="1-5-Post-load-Components"><a href="#1-5-Post-load-Components" class="headerlink" title="1.5 Post-load Components"></a>1.5 Post-load Components</h5>延迟加载组件。</li>
</ul>
<p>再看看你的页面然后问问自己，“什么是页面初始化必须的？”。剩下的内容和组件可以延迟。</p>
<p>JavaScript是理想的（延迟）候选者，可以切分到onload事件之前和之后。比如拖放的js库可以延迟，因为拖动必须在页面初始化之后。其它可延迟的包括隐藏的内容，折叠起来的图片等等。</p>
<h5 id="1-6-Preload-Components"><a href="#1-6-Preload-Components" class="headerlink" title="1.6 Preload Components"></a>1.6 Preload Components</h5><p>预加载组件。</p>
<p>预加载看起来与延迟加载相反，但它的确有个不同的目标。通过预加载你可以利用浏览器的空闲时间来请求你将来会用到的组件。这样当用户访问下一个页面时，你会有更多的组件已经在缓存中，这样会极大加快页面加载。</p>
<p>有几种预加载类型：</p>
<ul>
<li>无条件预加载：一旦onload触发，你立即获取另外的组件。比如谷歌会在主页这样加载搜索结果页面用到的雪碧图。</li>
<li>有条件预加载：基于用户动作，你推测用户下一步会去哪里并加载相应组件。</li>
<li>预期的预加载：在发布重新设计（的网站）前提前加载。在旧网页预加载新网页的部分组件，那么切换到新网页时就不会是没有任何缓存了。<h5 id="1-7-Reduce-the-Number-of-DOM-Elements"><a href="#1-7-Reduce-the-Number-of-DOM-Elements" class="headerlink" title="1.7 Reduce the Number of DOM Elements"></a>1.7 Reduce the Number of DOM Elements</h5>减少dom数。</li>
</ul>
<p>一个复杂的页面意味着更多的内容要下载，以及更慢的dom访问。比如在有500dom数量的页面添加事件处理就和有5000dom数量的不同。</p>
<p>如果你的页面dom元素很多，那么意味着你可能需要删除无用的内容和标签来优化。</p>
<h5 id="1-8-Split-Components-Across-Domains"><a href="#1-8-Split-Components-Across-Domains" class="headerlink" title="1.8 Split Components Across Domains"></a>1.8 Split Components Across Domains</h5><p>把组件分散到不同的域名。</p>
<p>把组件分散到不同的域名允许你最大化并行下载数。由于DNS查询的副作用，最佳的不同域名数是2-4。</p>
<h5 id="1-9-Minimize-the-Number-of-iframes"><a href="#1-9-Minimize-the-Number-of-iframes" class="headerlink" title="1.9 Minimize the Number of iframes"></a>1.9 Minimize the Number of iframes</h5><p>最小化iframe的数量。</p>
<p>iframe允许html文档被插入到父文档。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe&gt;优点：</span><br><span class="line"></span><br><span class="line">- 帮助解决缓慢的第三方内容的加载，如广告和徽章</span><br><span class="line">- 安全沙盒</span><br><span class="line">- 并行下载脚本</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe&gt;缺点：</span><br><span class="line"></span><br><span class="line">- 即使空的也消耗（资源和时间）</span><br><span class="line">- 阻塞了页面的onload</span><br><span class="line">- 非语义化（标签）</span><br></pre></td></tr></table></figure>
<h5 id="1-10-No-404s"><a href="#1-10-No-404s" class="headerlink" title="1.10 No 404s"></a>1.10 No 404s</h5><p>不要404。</p>
<p>http请求是昂贵的，所以发出http请求但获得没用的响应（如404）是完全不必要的，并且会降低用户体验。</p>
<p>一些网站会有特别的404页面提高用户体验，但这仍然会浪费服务器资源。特别坏的是当链接指向外部js但却得到404结果。这样首先会降低（占用）并行下载数，其次浏览器可能会把404响应体当作js来解析，试图从里面找出可用的东西。</p>
<h4 id="2-Server"><a href="#2-Server" class="headerlink" title="2. Server"></a>2. Server</h4><h5 id="2-1-Use-a-Content-Delivery-Network"><a href="#2-1-Use-a-Content-Delivery-Network" class="headerlink" title="2.1 Use a Content Delivery Network"></a>2.1 Use a Content Delivery Network</h5><p>使用CDN。</p>
<p>用户接近你的服务器会减少响应时间。把你的内容发布到多个，地理上分散的服务器可以让页面加载更快。但怎么开始？</p>
<p>首先不要试图把你的架构重新设计成分布式架构。因为可能引进更多复杂性和不可控。</p>
<p>记住80-90%的终端用户响应时间花费在下载页面中的所有组件：图片、样式、脚本、falsh等等。这是<em>Performance Golden Rule</em>。不要从困难的重新设计后台架构开始，最好首先分发你的静态内容。这不仅可以减少响应时间，用CDN还很容易来做。</p>
<p>CDN是一群不同地点的服务器，可以更高效地分发内容到用户。一些大公司有自己的CDN。</p>
<h5 id="2-2-Add-an-Expires-or-a-Cache-Control-Header"><a href="#2-2-Add-an-Expires-or-a-Cache-Control-Header" class="headerlink" title="2.2 Add an Expires or a Cache-Control Header"></a>2.2 Add an Expires or a Cache-Control Header</h5><p>加<code>Expires或者Cache-Control头部</code>。</p>
<p>这条规则有两个方面：</p>
<ul>
<li>对静态组件：通过设置Expires头部来实现“永不过期”策略。</li>
<li>对动态组件：用合适的Cache-Control头部来帮助浏览器进行有条件请求。<br>页面越来越丰富，意味着更多脚本，样式，图片等等。第一次访问的用户可能需要发出多个请求，但使用Expires可以让这些组件被缓存。这避免了访问子页面时没必要的http请求。Expires一般用在图片上，但应该用在所有的组件上。</li>
</ul>
<p>浏览器（以及代理）使用缓存来减少http请求数，加快页面加载。服务器使用http响应的Expires头部来告诉客户端一个组件可以缓存多久。比如下面：</p>
<p>Expires: Thu, 15 Apr 2010 20:00:00 GMT //2010-04-15之前都是稳定的</p>
<h6 id="注意，如果你设置了Expires头部，当组件更新后，你必须更改文件名。"><a href="#注意，如果你设置了Expires头部，当组件更新后，你必须更改文件名。" class="headerlink" title="注意，如果你设置了Expires头部，当组件更新后，你必须更改文件名。"></a>注意，如果你设置了Expires头部，当组件更新后，你必须更改文件名。</h6><h5 id="2-3-Gzip-Components"><a href="#2-3-Gzip-Components" class="headerlink" title="2.3 Gzip Components"></a>2.3 Gzip Components</h5><p>传输时用gzip等压缩组件。</p>
<p>http请求或响应的传输时间可以被前端工程师显著减少。终端用户的带宽，ISP，接近对等交换点等等没法被开发团队控制，但是，压缩可以通过减少http响应的大小减少响应时间。</p>
<p>从HTTP/1.1开始，客户端通过http请求中的Accept-Encoding头部来提示支持的压缩：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Accept-Encoding: gzip, deflate</span><br></pre></td></tr></table></figure></p>
<p>如果服务器看到这个头部，它可能会选用列表中的某个方法压缩响应。服务器通过Content-Encoding头部提示客户端：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Content-Encoding: gzip</span><br></pre></td></tr></table></figure></p>
<p>gzip一般可减小响应的70%。尽可能去gzip更多（文本）类型的文件。html，脚本，样式，xml和json等等都应该被gzip，而图片，pdf等等不应该被gzip，因为它们本身已被压缩过，gzip它们只是浪费cpu，甚至增加文件大小。</p>
<h5 id="2-4-Configure-ETags"><a href="#2-4-Configure-ETags" class="headerlink" title="2.4 Configure ETags"></a>2.4 Configure ETags</h5><p>实体标记（Entity tags，ETag）是服务器和浏览器之间判断浏览器缓存中某个组件是否匹配服务器端原组件的一种机制。实体就是组件：图片，脚本，样式等等。ETag被当作验证实体的比最后更改（last-modified）日期更高效的机制。服务器这样设置组件的ETag：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Last-Modified: Tue, 12 Dec 2006 03:03:59 GMT</span><br><span class="line">ETag: &quot;10c24bc-4ab-457e1c1f&quot;</span><br><span class="line">Content-Length: 12195</span><br></pre></td></tr></table></figure></p>
<p>之后，如果浏览器要验证组件，它用If-None-Match头部来传ETag给服务器。如果ETag匹配，服务器返回304：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">GET /i/yahoo.gif HTTP/1.1</span><br><span class="line">Host: us.yimg.com</span><br><span class="line">If-Modified-Since: Tue, 12 Dec 2006 03:03:59 GMT</span><br><span class="line">If-None-Match: &quot;10c24bc-4ab-457e1c1f&quot;</span><br><span class="line">HTTP/1.1 304 Not Modified</span><br></pre></td></tr></table></figure></p>
<p>ETag的问题是它们被构造来使它们对特定的运行这个网站的服务器唯一。浏览器从一个服务器获取组件，之后向另一个服务器验证，ETag将不匹配。然而服务器集群是处理请求的通用解决方案。</p>
<p>如果不能解决多服务器间的ETag匹配问题，那么删除ETag可能更好。</p>
<h5 id="2-5-Flush-the-Buffer-Early"><a href="#2-5-Flush-the-Buffer-Early" class="headerlink" title="2.5 Flush the Buffer Early"></a>2.5 Flush the Buffer Early</h5><p>早一点刷新buffer（尽早给浏览器数据）。</p>
<p>当用户请求一个页面，服务器一般要花200-500ms来拼凑整个页面。这段时间，浏览器是空闲的（等数据返回）。在php，有个方法flush()允许你传输部分准备好的html响应给浏览器。这样的话浏览器就可以开始下载组件，而同时后台可以继续生成页面剩下的部分。这种好处更多是在忙碌的后台或轻前端网站可以看到。</p>
<p>一个比较好的flush的位置是在head之后，因为浏览器可以加载其中的样式和脚本文件，而后台继续生成页面剩余部分。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- css, js --&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;?php flush(); ?&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;!-- content --&gt;</span><br></pre></td></tr></table></figure></p>
<h5 id="2-6-Use-GET-for-AJAX-Requests"><a href="#2-6-Use-GET-for-AJAX-Requests" class="headerlink" title="2.6 Use GET for AJAX Requests"></a>2.6 Use GET for AJAX Requests</h5><p>ajax请求用get。</p>
<p>Yahoo! Mail团队发现当使用XMLHttpRequest，POST 被浏览器实现为两步：首先发送头部，然后发送数据。所以使用GET最好，仅用一个TCP包发送（除非cookie太多）。IE的url长度限制是2K。</p>
<p>POST但不提交任何数据根GET行为类似，但从语义上讲，获取数据应该用GET，提交数据到服务器用POST。</p>
<h5 id="2-7-Avoid-Empty-Image-src"><a href="#2-7-Avoid-Empty-Image-src" class="headerlink" title="2.7 Avoid Empty Image src"></a>2.7 Avoid Empty Image src</h5><p>避免空src的图片。</p>
<p>空src属性的图片的行为可能跟你预期的不一样。它有两种形式：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">html标签：&lt;img src=&quot;&quot;&gt;</span><br></pre></td></tr></table></figure></p>
<p>js：var img = new Image(); img.src = “”;<br>两种都会造成同一种后果：浏览器会向你的服务器发请求。</p>
<ul>
<li>IE，向页面所在的目录发请求。</li>
<li>Safari和Chrome，请求实际的页面。</li>
<li>FireFox3及之前和Safari/Chrome一样，但从3.5开始修复问题，不再发请求。</li>
<li><p>Opera遇到空图片src不做任何事。</p>
<h6 id="为什么这种行为很糟糕？"><a href="#为什么这种行为很糟糕？" class="headerlink" title="为什么这种行为很糟糕？"></a>为什么这种行为很糟糕？</h6></li>
<li><ol>
<li>由于发送大量的意料之外的流量，会削弱服务器，尤其那些每天pv上百万的页面。</li>
</ol>
</li>
<li><ol start="2">
<li>浪费服务器计算周期取生成不会被浏览的页面。</li>
</ol>
</li>
<li><ol start="3">
<li>可能会破坏用户数据。如果你在跟踪请求状态，通过cookie或其它，你可能会破坏数据。即使image的请求不会返回图片，但所有的头部数据都被浏览器读取了，包括cookie。即使剩下的响应体被丢弃，破坏可能已经发生。<br>这种行为的根源是uri解析发生在浏览器。RFC 3986 定义了这种行为，空字符串被当作相对路径，Firefox, Safari, 和 Chrome都正确解析，而IE错误。总之，浏览器解析空字符串为相对路径的行为被认为是符合预期的。</li>
</ol>
</li>
</ul>
<p>html5在<em>4.8.2</em>添加了对标签src属性的描述，指导浏览器不要发出额外的请求。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The src attribute must be present, and must contain a valid URL referencing a non-interactive, optionally animated, image resource that is neither paged nor scripted. If the base URI of the element is the same as the document&apos;s address, then the src attribute&apos;s value must not be the empty string.</span><br></pre></td></tr></table></figure></p>
<p>幸运的是将来浏览器不会有这个问题了（在图片上）。不幸的是，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=&quot;&quot;&gt;和&lt;link href=&quot;&quot;&gt;</span><br></pre></td></tr></table></figure></p>
<p>没有这样的规范。</p>
<h4 id="3-Cookie"><a href="#3-Cookie" class="headerlink" title="3 Cookie"></a>3 Cookie</h4><h5 id="3-1-Reduce-Cookie-Size"><a href="#3-1-Reduce-Cookie-Size" class="headerlink" title="3.1 Reduce Cookie Size"></a>3.1 Reduce Cookie Size</h5><p>http cookie的使用有多种原因，比如授权和个性化。cookie的信息通过http头部在浏览器和服务器端交换。尽可能减小cookie的大小来降低响应时间。</p>
<ul>
<li>消除不必要的cookie。</li>
<li>尽可能减小cookie的大小来降低响应时间。</li>
<li>注意设置cookie到合适的域名级别，则其它子域名不会被影响。</li>
<li>正确设置Expires日期。早一点的Expires日期或者没有会尽早删除cookie，优化响应时间。<h5 id="3-2-Use-Cookie-free-Domains-for-Components"><a href="#3-2-Use-Cookie-free-Domains-for-Components" class="headerlink" title="3.2 Use Cookie-free Domains for Components"></a>3.2 Use Cookie-free Domains for Components</h5>用没有cookie的域名提供组件。</li>
</ul>
<p>当浏览器请求静态图片并把cookie一起发送到服务器时，cookie此时对服务器没什么用处。所以这些cookie只是增加了网络流量。所以你应该保证静态组件的请求是没有cookie的。可以创建一个子域名来托管所有静态组件。</p>
<p>比如，你域名是<a href="http://www.example.org，可以把静态组件托管在static.example.org。不过，你如果把cookie设置在顶级域名example.org下，这些cookie仍然会被传给static.example.org。这种情况下，启用一个全新的域名来托管静态组件。" target="_blank" rel="noopener">www.example.org，可以把静态组件托管在static.example.org。不过，你如果把cookie设置在顶级域名example.org下，这些cookie仍然会被传给static.example.org。这种情况下，启用一个全新的域名来托管静态组件。</a></p>
<p>另外一个用没有cookie的域名提供组件的好处是，某些代理可能会阻止缓存待cookie的静态组件请求。</p>
<h4 id="4-CSS"><a href="#4-CSS" class="headerlink" title="4. CSS"></a>4. CSS</h4><h5 id="4-1-Put-Stylesheets-at-the-Top"><a href="#4-1-Put-Stylesheets-at-the-Top" class="headerlink" title="4.1 Put Stylesheets at the Top"></a>4.1 Put Stylesheets at the Top</h5><p>把样式放在顶部。</p>
<p>研究雅虎网页性能时发现把样式表移到<head><meta name="generator" content="Hexo 3.8.0">里会让页面更快。这是因为把样式表移到<head><meta name="generator" content="Hexo 3.8.0">里允许页面逐步渲染。</head></head></p>
<p>关注性能的前端工程师希望页面被逐步渲染，这时因为，我们希望浏览器尽早渲染获取到的任何内容。这对大页面和网速慢的用户很重要。给用户视觉反馈，比如进度条的重要性已经被大量研究和记录。在我们的情况中，HTML页面就是进度条。当浏览器逐步加载页面头部，导航条，logo等等，这些都是给等待页面的用户的视觉反馈。这优化了整体用户体验。</p>
<p>把样式表放在文档底部的问题是它阻止了许多浏览器的逐步渲染，包括IE。这些浏览器阻止渲染来避免在样式更改时需要重绘页面元素。所以用户会卡在白屏。</p>
<p>HTML规范清楚表明样式应该在<head><meta name="generator" content="Hexo 3.8.0">里。</head></p>
<h5 id="4-2-Avoid-CSS-Expressions"><a href="#4-2-Avoid-CSS-Expressions" class="headerlink" title="4.2 Avoid CSS Expressions"></a>4.2 Avoid CSS Expressions</h5><p>避免CSS表达式。</p>
<p>CSS表达式是强大的（可能也是危险的）设置动态CSS属性的方法。IE5开始支持，IE8开始不赞成使用。例如，背景颜色可以设置成每小时轮换：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">background-color: expression( (new Date()).getHours()%2 ? &quot;#B8D4FF&quot; : &quot;#F08A00&quot; );</span><br></pre></td></tr></table></figure></p>
<p>CSS表达式的问题是它们可能比大多数人预期的计算的更频繁。它们不仅在页面载入和调整大小时重新计算，也在滚动页面甚至是用户在页面上移动鼠标时计算。比如在页面上移动鼠标可能轻易计算超过10000次。</p>
<p>要避免CSS表达式计算太多次，可以在它第一次计算后替换成确切值，或者用事件处理函数而不是CSS表达式。</p>
<h4 id="4-3-Choose-over-import"><a href="#4-3-Choose-over-import" class="headerlink" title="4.3 Choose  over @import"></a>4.3 Choose <link> over @import</h4><p>选择<link>而不是@import。</p>
<p>之前的一个最佳原则是说CSS应该在顶部来允许逐步渲染。</p>
<p>在IE用@import和把CSS放到页面底部行为一致，所以最好别用。</p>
<h5 id="4-4-Avoid-Filters"><a href="#4-4-Avoid-Filters" class="headerlink" title="4.4 Avoid Filters"></a>4.4 Avoid Filters</h5><p>避免使用（IE）过滤器。</p>
<p>IE专有的AlphaImageLoader过滤器用于修复IE7以下版本的半透明真彩色PNG的问题。这个过滤器的问题是它阻止了渲染，并在图片下载时冻结了浏览器。另外它还引起内存消耗，并且它被应用到每个元素而不是每个图片，所以问题（的严重性）翻倍了。</p>
<p>最佳做法是放弃AlphaImageLoader，改用PNG8来优雅降级。</p>
<h4 id="5-JavaScript"><a href="#5-JavaScript" class="headerlink" title="5. JavaScript"></a>5. JavaScript</h4><h5 id="5-1-Put-Scripts-at-the-Bottom"><a href="#5-1-Put-Scripts-at-the-Bottom" class="headerlink" title="5.1 Put Scripts at the Bottom"></a>5.1 Put Scripts at the Bottom</h5><p>把脚本放到底部。</p>
<p>脚本引起的问题是它们阻塞了并行下载。HTTP1.1规范建议浏览器每个域名下不要一次下载超过2个组件。如果你的图片分散在不同服务器，那么你能并行下载多个图片。但当脚本在下载，浏览器不会再下载其它组件，即使在不同域名下。</p>
<p>有些情况下把脚本移动到底部并不简单。比如，脚本中用了document.write来插入内容，它就不能被移动到底部。另外有可能有作用域问题。但大多数情况，有方法可以解决这些问题。</p>
<p>一个替代建议是使用异步脚本。defer属性表明脚本不包含document.write，是提示浏览器继续渲染的线索。不幸的是，Firefox不支持。如果脚本能异步，那么也就可以移动到底部。</p>
<h5 id="5-2-Make-JavaScript-and-CSS-External"><a href="#5-2-Make-JavaScript-and-CSS-External" class="headerlink" title="5.2 Make JavaScript and CSS External"></a>5.2 Make JavaScript and CSS External</h5><p>使用外部JS和CSS。</p>
<p>这里的很多性能规则涉及外部组件怎么管理。但你首先要明白一个基本问题：JS和CSS是应该包含在外部文件还是內连在页面本身？</p>
<p>真实世界中使用外部文件一般会加快页面，因为JS和CSS文件被浏览器缓存了。內连的JS和CSS怎在每次HTML文档下载时都被下载。內连减少了http请求，但增加了HTML文档大小。另一方面，如果JS和CSS被缓存了，那么HTML文档可以减小大小而不增加HTTP请求。</p>
<p>核心因素，就是JS和CSS被缓存相对于HTML文档被请求的频率。尽管这个因素很难被量化，但可以用不同的指标来计算。如果网站用户每个session有多个pv，许多页面重用相同的JS和CSS，那么有很大可能用外部JS和CSS更好。</p>
<p>许多网站用这些指标计算后在中间位置。对这些网站来说，最佳方案还是用外部JS和CSS文件。唯一例外是內连更被主页偏爱，如<a href="http://www.yahoo.com/。主页每个session可能只有少量的甚至一个pv，这时候內连可能更快。" target="_blank" rel="noopener">http://www.yahoo.com/。主页每个session可能只有少量的甚至一个pv，这时候內连可能更快。</a></p>
<p>对多个页面的首页来说，可以通过技术减少（其它页面的）http请求。在首页用內连，初始化后动态加载外部文件，接下来的页面如果用到这些文件，就可以使用缓存了。</p>
<h5 id="5-3-Minify-JavaScript-and-CSS"><a href="#5-3-Minify-JavaScript-and-CSS" class="headerlink" title="5.3 Minify JavaScript and CSS"></a>5.3 Minify JavaScript and CSS</h5><p>压缩JS和CSS。</p>
<p>压缩就是删除代码中不必要的字符来减小文件大小，从而提高加载速度。当代码压缩时，注释删除，不需要的空格（空白，换行，tab）也被删除。</p>
<p>混淆是对代码可选的优化。它比压缩更复杂，并且可能产生bug。在对美国top10网站的调查，压缩可减小21%，而混淆可减小25%。</p>
<p>除了外部脚本和样式，內连的脚本和样式同样应该被压缩。</p>
<h5 id="5-4-Remove-Duplicate-Scripts"><a href="#5-4-Remove-Duplicate-Scripts" class="headerlink" title="5.4 Remove Duplicate Scripts"></a>5.4 Remove Duplicate Scripts</h5><p>删除重复的脚本。</p>
<p>在页面中引入相同的脚本两次会伤害性能。可能超出你的预料，美国top10网站的2家有重复脚本引入。两个主要因素造成同一页面引入相同脚本：团队大小和脚本数量。当确实引入重复脚本，会发出不必要的http请求和浪费js执行时间。</p>
<p>发出不必要的http请求发生在IE而不是Firefox。在IE，如果外部脚本引入两次且没有缓存，它会发出2个请求。即使脚本被缓存，刷新时也会发出额外请求。</p>
<p>除了增加http请求，时间被浪费在执行脚本多次上。不管IE还是Firefox都会执行多次。</p>
<p>一种避免多次引入脚本的方法是在模板系统实现一个脚本管理模块。</p>
<h5 id="5-5-Minimize-DOM-Access"><a href="#5-5-Minimize-DOM-Access" class="headerlink" title="5.5 Minimize DOM Access"></a>5.5 Minimize DOM Access</h5><p>最小化DOM访问。</p>
<p>用JS访问DOM元素是缓慢的，所以为了响应更好的页面，你应该：</p>
<ul>
<li>缓存访问过的元素的引用</li>
<li>在DOM树外更新节点，然后添加到DOM树</li>
<li>避免用JS实现固定布局<h5 id="5-6-Develop-Smart-Event-Handlers"><a href="#5-6-Develop-Smart-Event-Handlers" class="headerlink" title="5.6 Develop Smart Event Handlers"></a>5.6 Develop Smart Event Handlers</h5>开发聪明的事件处理</li>
</ul>
<p>有时候页面看起来不那么响应（响应速度慢），是因为绑定到不同元素的大量事件处理函数执行太多次。这是为什么使用<em>事件委托</em>是一种好方法。</p>
<p>另外，你不必等到onload事件来开始处理DOM树，DOMContentLoaded更快。大多时候你需要的只是想访问的元素已在DOM树中，所以你不必等到所有图片被下载。</p>
<h4 id="6-Images"><a href="#6-Images" class="headerlink" title="6 Images"></a>6 Images</h4><h5 id="6-1-Optimize-Images"><a href="#6-1-Optimize-Images" class="headerlink" title="6.1 Optimize Images"></a>6.1 Optimize Images</h5><p>优化图片</p>
<p>在设计师建好图片后，在上传图片到服务器前你仍可以做些事：</p>
<ul>
<li>检查gif图片的调色板大小是否匹配图片颜色数。</li>
<li>可以把gif转成png看看有没有变小。除了动画，gif一般可以转成png8。</li>
<li>运行pngcrush或其它工具压缩png。</li>
<li><p>运行jpegtran或其它工具压缩jpeg。</p>
<h5 id="6-2-Optimize-CSS-Sprites"><a href="#6-2-Optimize-CSS-Sprites" class="headerlink" title="6.2 Optimize CSS Sprites"></a>6.2 Optimize CSS Sprites</h5><p>优化CSS雪碧图</p>
</li>
<li><p>把图片横向合并而不是纵向，横向更小。</p>
</li>
<li>把颜色近似的图片合并到一张雪碧图，这样可以让颜色数更少，如果低于256就可以用png8.</li>
<li>“Be mobile-friendly”并且合并时图片间的间距不要太大。这对图片大小影响不是太大，但客户端解压时需要的内存更少。100×100是10000个像素，1000×1000是1000000个像素。<h5 id="6-3-Don’t-Scale-Images-in-HTML"><a href="#6-3-Don’t-Scale-Images-in-HTML" class="headerlink" title="6.3 Don’t Scale Images in HTML"></a>6.3 Don’t Scale Images in HTML</h5>不要在html中缩放图片</li>
</ul>
<p>不要因为你可以设置图片的宽高就去用比你需要的大得多的图片。如果你需要<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img width=&quot;100&quot; height=&quot;100&quot; src=&quot;mycat.jpg&quot; alt=&quot;My Cat&quot; /&gt;</span><br></pre></td></tr></table></figure></p>
<p>那么，就用100x100px的图片，而不是500x500px的。</p>
<h5 id="6-4-Make-favicon-ico-Small-and-Cacheable"><a href="#6-4-Make-favicon-ico-Small-and-Cacheable" class="headerlink" title="6.4 Make favicon.ico Small and Cacheable"></a>6.4 Make favicon.ico Small and Cacheable</h5><p>favicon.ico小且缓存</p>
<p>favicon.ico是在你服务器根路径的图片。邪恶的是即使你不关心它，浏览器仍然会请求它。所以最好不要响应404。另外由于在同一服务器，每次请求favicon.ico时也会带上cookie。这个图片还会影响下载顺序，比如在IE，如果你在onload时下载额外的组件，fcvicon会在这些组件之前被下载。</p>
<p>怎么减轻favicon.ico的缺点？</p>
<ul>
<li>小，最好1K以下</li>
<li>设置Expires头部。也许可以安全地设置为几个月。<h4 id="7-Mobile"><a href="#7-Mobile" class="headerlink" title="7 Mobile"></a>7 Mobile</h4><h5 id="7-1-Keep-Components-under-25K"><a href="#7-1-Keep-Components-under-25K" class="headerlink" title="7.1 Keep Components under 25K"></a>7.1 Keep Components under 25K</h5>保持组件小于25K</li>
</ul>
<p>这个限制与iPhone不缓存大于25K的组件相关。注意，这是非压缩（uncompressed）的文件大小。在这里minification（压缩，不要与compress混淆）很重要，因为gzip无法满足（iPhone）。</p>
<h5 id="7-2-Pack-Components-into-a-Multipart-Document"><a href="#7-2-Pack-Components-into-a-Multipart-Document" class="headerlink" title="7.2 Pack Components into a Multipart Document"></a>7.2 Pack Components into a Multipart Document</h5><p>打包组件到一个多部父文档</p>
<p>打包组件到一个多部父文档类似于带附件的邮件。它帮助你在一个http请求中获取多个组件，但注意，iPhone不支持。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/13/JavaScript类数组对象/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="张哲">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mamba">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/13/JavaScript类数组对象/" itemprop="url">JavaScript类数组对象</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-13T10:41:10+08:00">
                2019-05-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="类数组对象"><a href="#类数组对象" class="headerlink" title="类数组对象"></a>类数组对象</h4><p>类数组对象： 就是拥有一个length属性和若干索引属性的对象<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var array = [&apos;name&apos;, &apos;age&apos;, &apos;sex&apos;]</span><br><span class="line"></span><br><span class="line">var arrayLike = &#123;</span><br><span class="line">    0: &apos;name&apos;,</span><br><span class="line">    1: &apos;age&apos;,</span><br><span class="line">    2: &apos;sex&apos;,</span><br><span class="line">    length: 3</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="读写"><a href="#读写" class="headerlink" title="读写"></a>读写</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">console.log(array[0]); // name</span><br><span class="line">console.log(arrayLike[0]); // name</span><br><span class="line"></span><br><span class="line">array[0] = &apos;new name&apos;;</span><br><span class="line">arrayLike[0] = &apos;new name&apos;;</span><br></pre></td></tr></table></figure>
<h4 id="长度"><a href="#长度" class="headerlink" title="长度"></a>长度</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">console.log(array.length); // 3</span><br><span class="line">console.log(arrayLike.length); // 3</span><br></pre></td></tr></table></figure>
<h4 id="遍历"><a href="#遍历" class="headerlink" title="遍历"></a>遍历</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">for(var i = 0, len = array.length; i &lt; len; i++) &#123;</span><br><span class="line">   ……</span><br><span class="line">&#125;</span><br><span class="line">for(var i = 0, len = arrayLike.length; i &lt; len; i++) &#123;</span><br><span class="line">    ……</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>那类数组对象可以使用数组的方法吗？比如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arrayLike.push(&apos;4&apos;);</span><br></pre></td></tr></table></figure></p>
<p>然而上述代码会报错: arrayLike.push is not a function</p>
<h4 id="调用数组方法"><a href="#调用数组方法" class="headerlink" title="调用数组方法"></a>调用数组方法</h4><p>如果类数组就是任性的想用数组的方法怎么办呢？</p>
<p>既然无法直接调用，我们可以用 Function.call 间接调用：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var arrayLike = &#123;0: &apos;name&apos;, 1: &apos;age&apos;, 2: &apos;sex&apos;, length: 3 &#125;</span><br><span class="line"></span><br><span class="line">Array.prototype.join.call(arrayLike, &apos;&amp;&apos;); // name&amp;age&amp;sex</span><br><span class="line"></span><br><span class="line">Array.prototype.slice.call(arrayLike, 0); // [&quot;name&quot;, &quot;age&quot;, &quot;sex&quot;] </span><br><span class="line">// slice可以做到类数组转数组</span><br><span class="line"></span><br><span class="line">Array.prototype.map.call(arrayLike, function(item)&#123;</span><br><span class="line">    return item.toUpperCase();</span><br><span class="line">&#125;); </span><br><span class="line">// [&quot;NAME&quot;, &quot;AGE&quot;, &quot;SEX&quot;]</span><br></pre></td></tr></table></figure></p>
<h4 id="类数组转数组"><a href="#类数组转数组" class="headerlink" title="类数组转数组"></a>类数组转数组</h4><p>在上面的例子中已经提到了一种类数组转数组的方法，再补充三个：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">var arrayLike = &#123;0: &apos;name&apos;, 1: &apos;age&apos;, 2: &apos;sex&apos;, length: 3 &#125;</span><br><span class="line">// 1. slice</span><br><span class="line">Array.prototype.slice.call(arrayLike); // [&quot;name&quot;, &quot;age&quot;, &quot;sex&quot;] </span><br><span class="line">// 2. splice</span><br><span class="line">Array.prototype.splice.call(arrayLike, 0); // [&quot;name&quot;, &quot;age&quot;, &quot;sex&quot;] </span><br><span class="line">// 3. ES6 Array.from</span><br><span class="line">Array.from(arrayLike); // [&quot;name&quot;, &quot;age&quot;, &quot;sex&quot;] </span><br><span class="line">// 4. apply</span><br><span class="line">Array.prototype.concat.apply([], arrayLike)</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/11/移动端适配/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="张哲">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mamba">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/11/移动端适配/" itemprop="url">移动端适配</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-11T22:00:44+08:00">
                2019-05-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="移动端是做适配"><a href="#移动端是做适配" class="headerlink" title="移动端是做适配"></a>移动端是做适配</h3><ul>
<li>1.meta viewport</li>
<li>2.媒体查询</li>
<li>3.动态 rem 方案<h5 id="1-在html中的head加入下面这个代码"><a href="#1-在html中的head加入下面这个代码" class="headerlink" title="1.在html中的head加入下面这个代码"></a>1.在html中的head加入下面这个代码</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0，user-scalable=no&quot;&gt;</span><br><span class="line">//width=device-width: 让当前viewport宽度等于设备宽度</span><br><span class="line">//user-scalable=no: 禁止用户缩放</span><br><span class="line">//initial-scale=1.0: 设置页面的初始缩放值为不缩放</span><br><span class="line">//maximum-scale: 允许用户的最大缩放值为1.0</span><br><span class="line">//minimun-scale: 允许用户的最小缩放值为1.0</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h5 id="2-不同的设备采取不同的样式，实现该方法应用媒体查询"><a href="#2-不同的设备采取不同的样式，实现该方法应用媒体查询" class="headerlink" title="2.不同的设备采取不同的样式，实现该方法应用媒体查询"></a>2.不同的设备采取不同的样式，实现该方法应用媒体查询</h5><p>使用 media 查询来响应不同分辨率<br>如在引入外部样式时，只有满足条件最大宽度为425px时，example.css才生效：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel=&quot;stylesheet&quot; media=&quot;(max-width: 425px)&quot; href=&quot;example.css&quot; /&gt;</span><br></pre></td></tr></table></figure></p>
<p>在CSS内部，也可以用media来设置特定的情况下让某些样式生效，如下，即当最大宽度为425px时，该样式生效：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;style&gt;</span><br><span class="line">  @media (max-width: 425px) &#123;</span><br><span class="line">     ……</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p>
<p>使用动态 REM 方案保证手机端的显示效果<br>rem指的是根元素的字体大小，根元素一般指的是html</p>
<h5 id="3-动态rem即在js中设置"><a href="#3-动态rem即在js中设置" class="headerlink" title="3.动态rem即在js中设置"></a>3.动态rem即在js中设置</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var pageWidth = window.innerWidth</span><br><span class="line">document.write(&apos;&lt;style&gt;html&#123;font-size:&apos;+pageWidth/10+&apos;px;&#125;&lt;/style&gt;&apos;)</span><br></pre></td></tr></table></figure>
<p>这样可以保证整体页面的比例，不会导致页面变形</p>
<p>(2) 使用scss直接将px转换成rem,减少自己计算时间<br>例子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@function px2rem($px)&#123;</span><br><span class="line">    @return $px/$designWidth*5 + rem;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$designWidth: 750;</span><br><span class="line">1rem = px2rem(150) =150px;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/11/Promise/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="张哲">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mamba">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/11/Promise/" itemprop="url">Promise</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-11T14:55:12+08:00">
                2019-05-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="Promise-是一个异步操作返回的对象，用来传递异步操作的消息。"><a href="#Promise-是一个异步操作返回的对象，用来传递异步操作的消息。" class="headerlink" title="Promise 是一个异步操作返回的对象，用来传递异步操作的消息。"></a>Promise 是一个异步操作返回的对象，用来传递异步操作的消息。</h4><h5 id="根据自己对-Promise-的理解，实现一个Promise"><a href="#根据自己对-Promise-的理解，实现一个Promise" class="headerlink" title="根据自己对 Promise 的理解，实现一个Promise :"></a>根据自己对 Promise 的理解，实现一个Promise :</h5><h6 id="Promise-有三种状态：Pending-初始态；-Fulfilled-成功态；-Rejected-失败态。"><a href="#Promise-有三种状态：Pending-初始态；-Fulfilled-成功态；-Rejected-失败态。" class="headerlink" title="Promise 有三种状态：Pending 初始态； Fulfilled 成功态； Rejected 失败态。"></a>Promise 有三种状态：Pending 初始态； Fulfilled 成功态； Rejected 失败态。</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">function Promise(executor) &#123;</span><br><span class="line">    let self = this;</span><br><span class="line">    self.status = &apos;pending&apos;; //等待态</span><br><span class="line">    self.value = undefined;  //成功的返回值</span><br><span class="line">    self.reason = undefined; //失败的原因</span><br><span class="line"></span><br><span class="line">    function resolve(value)&#123;</span><br><span class="line">        if(self.status === &apos;pending&apos;)&#123;</span><br><span class="line">            self.status = &apos;resolved&apos;;</span><br><span class="line">            self.value = value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    function reject(reason) &#123;</span><br><span class="line">        if(self.status === &apos;pending&apos;) &#123;</span><br><span class="line">            self.status = &apos;rejected&apos;;</span><br><span class="line">            self.reason = reason;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    try&#123;</span><br><span class="line">        executor(resolve, reject);</span><br><span class="line">    &#125;catch(e)&#123;</span><br><span class="line">        reject(e);// 捕获时发生异常，就直接失败</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//onFufiled 成功的回调</span><br><span class="line">//onRejected 失败的回调</span><br><span class="line">Promise.prototype.then = function (onFufiled, onRejected) &#123;</span><br><span class="line">    let self = this;</span><br><span class="line">    if(self.status === &apos;resolved&apos;)&#123;</span><br><span class="line">        onFufiled(self.value);</span><br><span class="line">    &#125;</span><br><span class="line">    if(self.status === &apos;rejected&apos;)&#123;</span><br><span class="line">        onRejected(self.reason);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">module.exports = Promise;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/10/JavaScript继承/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="张哲">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mamba">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/10/JavaScript继承/" itemprop="url">JavaScript继承</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-10T18:49:53+08:00">
                2019-05-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="不用-class-如何实现继承？用-class-又如何实现？"><a href="#不用-class-如何实现继承？用-class-又如何实现？" class="headerlink" title="不用 class 如何实现继承？用 class 又如何实现？"></a>不用 class 如何实现继承？用 class 又如何实现？</h4><h5 id="不用-class-这样实现"><a href="#不用-class-这样实现" class="headerlink" title="不用 class 这样实现"></a>不用 class 这样实现</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">function Animal(color)&#123;</span><br><span class="line">    this.color = color</span><br><span class="line">&#125;</span><br><span class="line">Animal.prototype.move = function()&#123;&#125; // 动物可以动</span><br><span class="line">function Dog(color, name)&#123;</span><br><span class="line">    Animal.call(this, color) // 或者 Animal.apply(this, arguments)</span><br><span class="line">    this.name = name</span><br><span class="line">&#125;</span><br><span class="line">// 下面三行实现 Dog.prototype.__proto__ = Animal.prototype</span><br><span class="line">function temp()&#123;&#125;</span><br><span class="line">temp.prototye = Animal.prototype</span><br><span class="line">Dog.prototype = new temp()</span><br><span class="line"></span><br><span class="line">Dog.prototype.constuctor = Dog // 这行看不懂就算了</span><br><span class="line">Dog.prototype.say = function()&#123; console.log(&apos;汪&apos;)&#125;</span><br><span class="line"></span><br><span class="line">var dog = new Dog(&apos;黄色&apos;,&apos;阿黄&apos;)</span><br></pre></td></tr></table></figure>
<h5 id="用-class-就简单了"><a href="#用-class-就简单了" class="headerlink" title="用 class 就简单了"></a>用 class 就简单了</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">class Animal&#123;</span><br><span class="line">    constructor(color)&#123;</span><br><span class="line">        this.color = color</span><br><span class="line">    &#125;</span><br><span class="line">    move()&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">class Dog extends Animal&#123;</span><br><span class="line">    constructor(color, name)&#123;</span><br><span class="line">        super(color)</span><br><span class="line">        this.name = name</span><br><span class="line">    &#125;</span><br><span class="line">    say()&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/09/JavaScript数组-二/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="张哲">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mamba">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/09/JavaScript数组-二/" itemprop="url">JavaScript数组(二)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-09T17:21:36+08:00">
                2019-05-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/05/09/正则详解/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="张哲">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="mamba">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/05/09/正则详解/" itemprop="url">正则表达式整理</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-09T12:49:21+08:00">
                2019-05-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>开发中常用的一些正则表达式整理</p>
<h4 id="一、校验数字的表达式"><a href="#一、校验数字的表达式" class="headerlink" title="一、校验数字的表达式"></a>一、校验数字的表达式</h4><p>1 数字：^[0-9]*$</p>
<p>2 n位的数字：^\d{n}$</p>
<p>3 至少n位的数字：^\d{n,}$</p>
<p>4 m-n位的数字：^\d{m,n}$</p>
<p>5 零和非零开头的数字：^(0|[1-9][0-9]*)$</p>
<p>6 非零开头的最多带两位小数的数字：^([1-9][0-9]*)+(.[0-9]{1,2})?$</p>
<p>7 带1-2位小数的正数或负数：^(-)?\d+(.\d{1,2})?$</p>
<p>8 正数、负数、和小数：^(-|+)?\d+(.\d+)?$</p>
<p>9 有两位小数的正实数：^[0-9]+(.[0-9]{2})?$</p>
<p>10 有1~3位小数的正实数：^[0-9]+(.[0-9]{1,3})?$</p>
<p>11 非零的正整数：^[1-9]\d<em>$ 或 ^([1-9][0-9]</em>){1,3}$ 或 ^+?[1-9][0-9]*$</p>
<p>12 非零的负整数：^-[1-9][]0-9”<em>$ 或 ^-[1-9]\d</em>$</p>
<p>13 非负整数：^\d+$ 或 ^[1-9]\d*|0$</p>
<p>14 非正整数：^-[1-9]\d*|0$ 或 ^((-\d+)|(0+))$</p>
<p>15 非负浮点数：^\d+(.\d+)?$ 或 ^[1-9]\d<em>.\d</em>|0.\d<em>[1-9]\d</em>|0?.0+|0$</p>
<p>16 非正浮点数：^((-\d+(.\d+)?)|(0+(.0+)?))$ 或 ^(-([1-9]\d<em>.\d</em>|0.\d<em>[1-9]\d</em>))|0?.0+|0$</p>
<p>17 正浮点数：^[1-9]\d<em>.\d</em>|0.\d<em>[1-9]\d</em>$ 或 ^(([0-9]+.[0-9]<em>[1-9][0-9]</em>)|([0-9]<em>[1-9][0-9]</em>.[0-9]+)|([0-9]<em>[1-9][0-9]</em>))$</p>
<p>18 负浮点数：^-([1-9]\d<em>.\d</em>|0.\d<em>[1-9]\d</em>)$ 或 ^(-(([0-9]+.[0-9]<em>[1-9][0-9]</em>)|([0-9]<em>[1-9][0-9]</em>.[0-9]+)|([0-9]<em>[1-9][0-9]</em>)))$</p>
<p>19 浮点数：^(-?\d+)(.\d+)?$ 或 ^-?([1-9]\d<em>.\d</em>|0.\d<em>[1-9]\d</em>|0?.0+|0)$</p>
<h4 id="二、校验字符的表达式"><a href="#二、校验字符的表达式" class="headerlink" title="二、校验字符的表达式"></a>二、校验字符的表达式</h4><p>1 汉字：^[\u4e00-\u9fa5]{0,}$</p>
<p>2 英文和数字：^[A-Za-z0-9]+$ 或 ^[A-Za-z0-9]{4,40}$</p>
<p>3 长度为3-20的所有字符：^.{3,20}$</p>
<p>4 由26个英文字母组成的字符串：^[A-Za-z]+$</p>
<p>5 由26个大写英文字母组成的字符串：^[A-Z]+$</p>
<p>6 由26个小写英文字母组成的字符串：^[a-z]+$</p>
<p>7 由数字和26个英文字母组成的字符串：^[A-Za-z0-9]+$</p>
<p>8 由数字、26个英文字母或者下划线组成的字符串：^\w+$ 或 ^\w{3,20}$</p>
<p>9 中文、英文、数字包括下划线：^[\u4E00-\u9FA5A-Za-z0-9_]+$</p>
<p>10 中文、英文、数字但不包括下划线等符号：^[\u4E00-\u9FA5A-Za-z0-9]+$ 或 ^[\u4E00-\u9FA5A-Za-z0-9]{2,20}$</p>
<p>11 可以输入含有^%&amp;’,;=?$\”等字符：[^%&amp;’,;=?$\x22]+</p>
<p>12 禁止输入含有~的字符：[^~\x22]+</p>
<h4 id="三、特殊需求表达式"><a href="#三、特殊需求表达式" class="headerlink" title="三、特殊需求表达式"></a>三、特殊需求表达式</h4><p>1 Email地址：^\w+([-+.]\w+)<em>@\w+([-.]\w+)</em>.\w+([-.]\w+)*$</p>
<p>2 域名：[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(/.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+/.?</p>
<p>3 InternetURL：[a-zA-z]+://[^\s]<em> 或 ^http://([\w-]+.)+[\w-]+(/[\w-./?%&amp;=]</em>)?$</p>
<p>4 手机号码：^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$</p>
<p>5 电话号码(“XXX-XXXXXXX”、”XXXX-XXXXXXXX”、”XXX-XXXXXXX”、”XXX-XXXXXXXX”、”XXXXXXX”和”XXXXXXXX)：^((\d{3,4}-)|\d{3.4}-)?\d{7,8}$</p>
<p>6 国内电话号码(0511-4405222、021-87888822)：\d{3}-\d{8}|\d{4}-\d{7}</p>
<p>7 身份证号(15位、18位数字)：^\d{15}|\d{18}$</p>
<p>8 短身份证号码(数字、字母x结尾)：^([0-9]){7,18}(x|X)?$ 或 ^\d{8,18}|[0-9x]{8,18}|[0-9X]{8,18}?$</p>
<p>9 帐号是否合法(字母开头，允许5-16字节，允许字母数字下划线)：^[a-zA-Z][a-zA-Z0-9_]{4,15}$</p>
<p>10 密码(以字母开头，长度在6~18之间，只能包含字母、数字和下划线)：^[a-zA-Z]\w{5,17}$</p>
<p>11 强密码(必须包含大小写字母和数字的组合，不能使用特殊字符，长度在8-10之间)：^(?=.<em>\d)(?=.</em>[a-z])(?=.*[A-Z]).{8,10}$</p>
<p>12 日期格式：^\d{4}-\d{1,2}-\d{1,2}</p>
<p>13 一年的12个月(01～09和1～12)：^(0?[1-9]|1[0-2])$</p>
<p>14 一个月的31天(01～09和1～31)：^((0?[1-9])|((1|2)[0-9])|30|31)$</p>
<p>15 钱的输入格式：</p>
<p>16 1.有四种钱的表示形式我们可以接受:”10000.00” 和 “10,000.00”, 和没有 “分” 的 “10000” 和 “10,000”：^[1-9][0-9]*$</p>
<p>17 2.这表示任意一个不以0开头的数字,但是,这也意味着一个字符”0”不通过,所以我们采用下面的形式：^(0|[1-9][0-9]*)$</p>
<p>18 3.一个0或者一个不以0开头的数字.我们还可以允许开头有一个负号：^(0|-?[1-9][0-9]*)$</p>
<p>19 4.这表示一个0或者一个可能为负的开头不为0的数字.让用户以0开头好了.把负号的也去掉,因为钱总不能是负的吧.下面我们要加的是说明可能的小数部分：^[0-9]+(.[0-9]+)?$</p>
<p>20 5.必须说明的是,小数点后面至少应该有1位数,所以”10.”是不通过的,但是 “10” 和 “10.2” 是通过的：^[0-9]+(.[0-9]{2})?$</p>
<p>21 6.这样我们规定小数点后面必须有两位,如果你认为太苛刻了,可以这样：^[0-9]+(.[0-9]{1,2})?$</p>
<p>22 7.这样就允许用户只写一位小数.下面我们该考虑数字中的逗号了,我们可以这样：^[0-9]{1,3}(,[0-9]{3})*(.[0-9]{1,2})?$</p>
<p>23 8.1到3个数字,后面跟着任意个 逗号+3个数字,逗号成为可选,而不是必须：^([0-9]+|[0-9]{1,3}(,[0-9]{3})*)(.[0-9]{1,2})?$</p>
<p>24 备注：这就是最终结果了,别忘了”+”可以用”*”替代如果你觉得空字符串也可以接受的话(奇怪,为什么?)最后,别忘了在用函数时去掉去掉那个反斜杠,一般的错误都在这里</p>
<p>25 xml文件：^([a-zA-Z]+-?)+[a-zA-Z0-9]+\.[x|X][m|M][l|L]$</p>
<p>26 中文字符的正则表达式：[\u4e00-\u9fa5]</p>
<p>27 双字节字符：[^\x00-\xff] (包括汉字在内，可以用来计算字符串的长度(一个双字节字符长度计2，ASCII字符计1))</p>
<p>28 空白行的正则表达式：\n\s*\r (可以用来删除空白行)</p>
<p>29 HTML标记的正则表达式：&lt;(\s<em>?)[^&gt;]</em>&gt;.<em>?|&lt;.</em>?&gt; (网上流传的版本太糟糕，上面这个也仅仅能部分，对于复杂的嵌套标记依旧无能为力)</p>
<p>30 首尾空白字符的正则表达式：^\s<em>|\s</em>$或(^\s<em>)|(\s</em>$) (可以用来删除行首行尾的空白字符(包括空格、制表符、换页符等等)，非常有用的表达式)</p>
<p>31 腾讯QQ号：[1-9][0-9]{4,} (腾讯QQ号从10000开始)</p>
<p>32 中国邮政编码：[1-9]\d{5}(?!\d) (中国邮政编码为6位数字)</p>
<p>33 IP地址：\d+.\d+.\d+.\d+ (提取IP地址时有用)</p>
<p>34 IP地址：((?:(?:25[0-5]|2[0-4]\d|[01]?\d?\d)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d?\d))</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">张哲</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">45</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/mamba1202" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:1612786059@qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">张哲</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
